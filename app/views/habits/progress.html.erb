<div class="jumbotron p-3 jumbotron-fluid bg-light">
  <h1 class="display-5"><%= t('habits.progress.title.title') %></h1>
  <hr class="my-4">
  <div>
  <%= link_to t('habits.progress.link.habits.show'),
              habits_path(),
              type: 'button',
              class: 'btn btn-outline-secondary m-1' %>
  </div>

  <hr class="my-4">

  <div class="table-responsive-sm">
    <table class="table table-bordered table-sm table-condensed">
      <thead>
        <tr>
          <th class="m-0 p-0"><%= @now.strftime("%Y/%m") %></th>
          <% @dates.each do |date| %>
            <th class="m-0 p-0 text-center"><%= date.strftime("%d") %></th>
          <% end %>
        </tr>
      </thead>

      <tbody>
      <% @habits.each do |habit| %>
        <tr>
          <th class="m-0 py-0" title="<%= habit.name %>" ><%= truncate(habit.name, length: 10) %></th>

          <% @dates.each do |date| %>
            <% if (habit_day = habit.habit_day_by_date(date)) %>
              <td class="text-center">
                <%= form_for(habit_day, method: :delete) do |f| %>
                  <%= f.submit '', class: 'px-3 btn-success' %>
                <% end %>
              </td>
            <% else %>
              <td class="text-center">
                <%= form_for(habit.habit_days.new) do |f| %>
                  <%= f.hidden_field :habit_id, value: habit.id %>
                  <%= f.hidden_field :date, as: :date, value: date.to_date.to_s %>
                  <%= f.submit '', class: 'px-3 btn-light' %>
                <% end %>
              </td>
            <% end %>
          <% end %>
        </tr>
      <% end %>

      </tbody>
    </table>
  </div>
</div>

<style>
  tr td {
    padding: 0 !important;
    margin: 0 !important;
  }
</style>